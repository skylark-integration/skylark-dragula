{"version":3,"sources":["emitter.js"],"names":["define","atoa","debounce","thing","options","opts","evt","undefined","on","type","fn","push","once","_once","off","c","arguments","length","et","splice","indexOf","emit","args","emitterSnapshot","shift","apply","this","slice","ctx","throws","forEach","listen","async"],"mappings":";;;;;;;AAAAA,QACC,SACA,cACC,SAASC,EAAKC,GACZ,aAgEA,OA9DH,SAAiBC,EAAOC,GACjB,IAAIC,EAAOD,MACPE,KAyDJ,YAxDcC,IAAVJ,IACAA,MAEJA,EAAMK,GAAK,SAASC,EAAMC,GAMtB,OALKJ,EAAIG,GAGLH,EAAIG,GAAME,KAAKD,GAFfJ,EAAIG,IAASC,GAIVP,GAEXA,EAAMS,KAAO,SAASH,EAAMC,GAGxB,OAFAA,EAAGG,OAAQ,EACXV,EAAMK,GAAGC,EAAMC,GACRP,GAEXA,EAAMW,IAAM,SAASL,EAAMC,GACvB,IAAIK,EAAIC,UAAUC,OAClB,GAAU,IAANF,SACOT,EAAIG,QACR,GAAU,IAANM,EACPT,SACG,CACH,IAAIY,EAAKZ,EAAIG,GACb,IAAKS,EACD,OAAOf,EAEXe,EAAGC,OAAOD,EAAGE,QAAQV,GAAK,GAE9B,OAAOP,GAEXA,EAAMkB,KAAO,WACT,IAAIC,EAAOrB,EAAKe,WAChB,OAAOb,EAAMoB,gBAAgBD,EAAKE,SAASC,MAAMC,KAAMJ,IAE3DnB,EAAMoB,gBAAkB,SAASd,GAC7B,IAAIS,GAAMZ,EAAIG,QAAakB,MAAM,GACjC,OAAO,WACH,IAAIL,EAAOrB,EAAKe,WACZY,EAAMF,MAAQvB,EAClB,GAAa,UAATM,IAAoC,IAAhBJ,EAAKwB,SAAqBX,EAAGD,OACjD,MAAsB,IAAhBK,EAAKL,OAAeK,EAAK,GAAKA,EAYxC,OAVAJ,EAAGY,QAAQ,SAAiBC,GACpB1B,EAAK2B,MACL9B,EAAS6B,EAAQT,EAAMM,GAEvBG,EAAON,MAAMG,EAAKN,GAElBS,EAAOlB,OACPV,EAAMW,IAAIL,EAAMsB,KAGjB5B,IAGRA","file":"../emitter.js","sourcesContent":["define([\r\n\t\"./atoa\",\r\n\t\"./debounce\"\r\n],function(atoa,debounce){\r\n    'use strict';\r\n\r\n\tfunction emitter(thing, options) {\r\n        var opts = options || {};\r\n        var evt = {};\r\n        if (thing === undefined) {\r\n            thing = {};\r\n        }\r\n        thing.on = function(type, fn) {\r\n            if (!evt[type]) {\r\n                evt[type] = [fn];\r\n            } else {\r\n                evt[type].push(fn);\r\n            }\r\n            return thing;\r\n        };\r\n        thing.once = function(type, fn) {\r\n            fn._once = true; // thing.off(fn) still works!\r\n            thing.on(type, fn);\r\n            return thing;\r\n        };\r\n        thing.off = function(type, fn) {\r\n            var c = arguments.length;\r\n            if (c === 1) {\r\n                delete evt[type];\r\n            } else if (c === 0) {\r\n                evt = {};\r\n            } else {\r\n                var et = evt[type];\r\n                if (!et) {\r\n                    return thing;\r\n                }\r\n                et.splice(et.indexOf(fn), 1);\r\n            }\r\n            return thing;\r\n        };\r\n        thing.emit = function() {\r\n            var args = atoa(arguments);\r\n            return thing.emitterSnapshot(args.shift()).apply(this, args);\r\n        };\r\n        thing.emitterSnapshot = function(type) {\r\n            var et = (evt[type] || []).slice(0);\r\n            return function() {\r\n                var args = atoa(arguments);\r\n                var ctx = this || thing;\r\n                if (type === 'error' && opts.throws !== false && !et.length) {\r\n                    throw args.length === 1 ? args[0] : args;\r\n                }\r\n                et.forEach(function emitter(listen) {\r\n                    if (opts.async) {\r\n                        debounce(listen, args, ctx);\r\n                    } else {\r\n                        listen.apply(ctx, args);\r\n                    }\r\n                    if (listen._once) {\r\n                        thing.off(type, listen);\r\n                    }\r\n                });\r\n                return thing;\r\n            };\r\n        };\r\n        return thing;\r\n    }\r\n\r\n    return emitter;\r\n});"]}