/**
 * skylark-dragula - A version of dragula.js that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-dragula/
 * @license MIT
 */
!function(e,n){var r=n.define,require=n.require,t="function"==typeof r&&r.amd,i=!t&&"undefined"!=typeof exports;if(!t&&!r){var o={};r=n.define=function(e,n,r){"function"==typeof r?(o[e]={factory:r,deps:n.map(function(n){return function(e,n){if("."!==e[0])return e;var r=n.split("/"),t=e.split("/");r.pop();for(var i=0;i<t.length;i++)"."!=t[i]&&(".."==t[i]?r.pop():r.push(t[i]));return r.join("/")}(n,e)}),resolved:!1,exports:null},require(e)):o[e]={factory:null,resolved:!0,exports:r}},require=n.require=function(e){if(!o.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=o[e];if(!module.resolved){var r=[];module.deps.forEach(function(e){r.push(require(e))}),module.exports=module.factory.apply(n,r)||null,module.resolved=!0}return module.exports}}if(!r)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-langx-emitter/Emitter",["skylark-langx-events"],function(e){return e.Emitter}),e("skylark-dragula/emitter",["skylark-langx-emitter/Emitter"],function(e){var n=e.inherit({_prepareArgs:function(e,n){return n},init:function(e,n){void 0===e&&(e={}),Object.assign(this,e)}});return n}),e("skylark-dragula/dragula",["skylark-langx/skylark","skylark-devices-points/mouse","skylark-devices-points/touch","skylark-domx-noder","skylark-domx-finder","skylark-domx-geom","skylark-domx-eventer","skylark-domx-styler","./emitter"],function(e,n,r,t,i,o,a,u,l){"use strict";var c=window,d=c.document,s=d.documentElement;function f(e,n,t,i){"add"==n?a.on(e,t,i):a.off(e,t,i),e.touchInited||(e.touchInited=!0,r.mousy(e))}function v(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.which&&0!==e.which)return e.which;if(void 0!==e.buttons)return e.buttons;var n=e.button;return void 0!==n?1&n?1:2&n?3:4&n?2:0:void 0}function p(){return!1}function g(){return!0}function m(e){return e.width||e.right-e.left}function h(e){return e.height||e.bottom-e.top}function y(e,n){var r=function(e){if(e.targetTouches&&e.targetTouches.length)return e.targetTouches[0];if(e.changedTouches&&e.changedTouches.length)return e.changedTouches[0];return e}(n),t={pageX:"clientX",pageY:"clientY"};return e in t&&!(e in r)&&t[e]in r&&(e=t[e]),r[e]}return e.attach("intg.dragula",function(e,n){var r,c,k,x,S,C,b,w,O,T,X;1===arguments.length&&!1===Array.isArray(e)&&(n=e,e=[]);var Y,E=null,I=n||{};void 0===I.moves&&(I.moves=g);void 0===I.accepts&&(I.accepts=g);void 0===I.invalid&&(I.invalid=function(){return!1});void 0===I.containers&&(I.containers=e||[]);void 0===I.isContainer&&(I.isContainer=p);void 0===I.copy&&(I.copy=!1);void 0===I.copySortSource&&(I.copySortSource=!1);void 0===I.revertOnSpill&&(I.revertOnSpill=!1);void 0===I.removeOnSpill&&(I.removeOnSpill=!1);void 0===I.direction&&(I.direction="vertical");void 0===I.ignoreInputTextSelection&&(I.ignoreInputTextSelection=!0);void 0===I.mirrorContainer&&(I.mirrorContainer=d.body);var P=l({containers:I.containers,start:function(e){var n=M(e);n&&N(n)},end:z,cancel:J,remove:H,destroy:function(){q(!0),F({})},canMove:function(e){return!!M(e)},dragging:!1});!0===I.removeOnSpill&&P.on("over",function(e){u.removeClass(e,"gu-hide")}).on("out",function(e){P.dragging&&u.addClass(e,"gu-hide")});return q(),P;function j(e){return-1!==P.containers.indexOf(e)||I.isContainer(e)}function q(e){var n=e?"remove":"add";f(s,n,"mousedown",R),f(s,n,"mouseup",F)}function A(e){var n=e?"remove":"add";f(s,n,"mousemove",K)}function B(e){var n=e?"off":"on";a[n](s,"selectstart",D),a[n](s,"click",D)}function D(e){Y&&e.preventDefault()}function R(e){C=e.clientX,b=e.clientY;var n=1!==v(e)||e.metaKey||e.ctrlKey;if(!n){var r=e.target,i=M(r);i&&(Y=i,A(),"mousedown"===e.type&&(t.isInput(r)?r.focus():e.preventDefault()))}}function K(e){if(Y)if(0!==v(e)){if(void 0===e.clientX||e.clientX!==C||void 0===e.clientY||e.clientY!==b){if(I.ignoreInputTextSelection){var n=y("clientX",e),i=y("clientY",e),a=t.fromPoint(n,i);if(t.isInput(a))return}var l=Y;A(!0),B(),z(),N(l);var c=o.pagePosition(k);x=y("pageX",e)-c.left,S=y("pageY",e)-c.top,u.addClass(T||k,"gu-transit"),function(){if(r)return;var e=k.getBoundingClientRect();(r=k.cloneNode(!0)).style.width=m(e)+"px",r.style.height=h(e)+"px",u.removeClass(r,"gu-transit"),u.addClass(r,"gu-mirror"),I.mirrorContainer.appendChild(r),f(s,"add","mousemove",V),u.addClass(I.mirrorContainer,"gu-unselectable"),P.emit("cloned",r,k,"mirror")}(),V(e)}}else F({})}function M(e){if(!(P.dragging&&r||j(e))){for(var n=e;i.parent(e)&&!1===j(i.parent(e));){if(I.invalid(e,n))return;if(!(e=i.parent(e)))return}var t=i.parent(e);if(t&&!I.invalid(e,n)){var o=I.moves(e,t,n,i.nextSibling(e));if(o)return{item:e,source:t}}}}function N(e){var n,r;n=e.item,r=e.source,("boolean"==typeof I.copy?I.copy:I.copy(n,r))&&(T=e.item.cloneNode(!0),P.emit("cloned",T,e.item,"copy")),c=e.source,k=e.item,w=O=i.nextSibling(e.item),P.dragging=!0,P.emit("drag",k,c)}function z(){if(P.dragging){var e=T||k;G(e,i.parent(e))}}function _(){Y=!1,A(!0),B(!0)}function F(e){if(_(),P.dragging){var n=T||k,r=y("clientX",e),i=y("clientY",e),o=t.fromPoint(r,i),a=U(o,r,i);a&&(T&&I.copySortSource||!T||a!==c)?G(n,a):I.removeOnSpill?H():J()}}function G(e,n){var r=i.parent(e);T&&I.copySortSource&&n===c&&r.removeChild(k),Q(n)?P.emit("cancel",e,c,c):P.emit("drop",e,n,c,O),L()}function H(){if(P.dragging){var e=T||k,n=i.parent(e);n&&n.removeChild(e),P.emit(T?"cancel":"remove",e,n,c),L()}}function J(e){if(P.dragging){var n=arguments.length>0?e:I.revertOnSpill,r=T||k,t=i.parent(r),o=Q(t);!1===o&&n&&(T?t&&t.removeChild(T):c.insertBefore(r,w)),o||n?P.emit("cancel",r,c,c):P.emit("drop",r,t,c,O),L()}}function L(){var e=T||k;_(),r&&(u.removeClass(I.mirrorContainer,"gu-unselectable"),f(s,"remove","mousemove",V),i.parent(r).removeChild(r),r=null),e&&u.removeClass(e,"gu-transit"),X&&clearTimeout(X),P.dragging=!1,E&&P.emit("out",e,E,c),P.emit("dragend",e),c=k=T=w=O=X=E=null}function Q(e,n){var t;return t=void 0!==n?n:r?O:i.nextSibling(T||k),e===c&&t===w}function U(e,n,r){for(var t=e;t&&!o();)t=i.parent(t);return t;function o(){var i=j(t);if(!1===i)return!1;var o=W(t,e),a=Z(t,o,n,r),u=Q(t,a);return!!u||I.accepts(k,t,c,a)}}function V(e){if(r){e.preventDefault();var n=y("clientX",e),o=y("clientY",e),a=n-x,u=o-S;r.style.left=a+"px",r.style.top=u+"px";var l=T||k,d=t.fromPoint(n,o),s=U(d,n,o),f=null!==s&&s!==E;(f||null===s)&&(E&&m("out"),E=s,f&&m("over"));var v=i.parent(l);if(s!==c||!T||I.copySortSource){var p,g=W(s,d);if(null!==g)p=Z(s,g,n,o);else{if(!0!==I.revertOnSpill||T)return void(T&&v&&v.removeChild(l));p=w,s=c}(null===p&&f||p!==l&&p!==i.nextSibling(l))&&(O=p,s.insertBefore(l,p),P.emit("shadow",l,s,c))}else v&&v.removeChild(l)}function m(e){P.emit(e,l,E,c)}}function W(e,n){for(var r=n;r!==e&&i.parent(r)!==e;)r=i.parent(r);return r===s?null:r}function Z(e,n,r,t){var a="horizontal"===I.direction,u=n!==e?function(){var e=o.boundingRect(n);if(a)return l(r>e.left+m(e)/2);return l(t>e.top+h(e)/2)}():function(){var n,i,u,l=e.children.length;for(n=0;n<l;n++){if(i=e.children[n],u=o.boundingRect(i),a&&u.left+u.width/2>r)return i;if(!a&&u.top+u.height/2>t)return i}return null}();return u;function l(e){return e?i.nextSibling(n):n}}})}),e("skylark-dragula/main",["./dragula"],function(e){return e}),e("skylark-dragula",["skylark-dragula/main"],function(e){return e})}(r),!t){var a=require("skylark-langx-ns");i?module.exports=a:n.skylarkjs=a}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-dragula.js.map
