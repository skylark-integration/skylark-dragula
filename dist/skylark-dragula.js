/**
 * skylark-dragula - A version of dragula.js that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-dragula/
 * @license MIT
 */
!function(t,e){var r=e.define,require=e.require,i="function"==typeof r&&r.amd,n=!i&&"undefined"!=typeof exports;if(!i&&!r){var o={};r=e.define=function(t,e,r){"function"==typeof r?(o[t]={factory:r,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var r=e.split("/"),i=t.split("/");r.pop();for(var n=0;n<i.length;n++)"."!=i[n]&&(".."==i[n]?r.pop():r.push(i[n]));return r.join("/")}(e,t)}),resolved:!1,exports:null},require(t)):o[t]={factory:null,resolved:!0,exports:r}},require=e.require=function(t){if(!o.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=o[t];if(!module.resolved){var r=[];module.deps.forEach(function(t){r.push(require(t))}),module.exports=module.factory.apply(e,r)||null,module.resolved=!0}return module.exports}}if(!r)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-domx-plugins-dnd/draggable",["skylark-langx/langx","skylark-domx-noder","skylark-domx-data","skylark-domx-finder","skylark-domx-geom","skylark-domx-eventer","skylark-domx-styler","skylark-devices-points/touch","skylark-domx-plugins-base","./dnd","./manager"],function(t,e,r,i,n,o,a,s,l,d,c){o.on,o.off,r.attr,r.removeAttr,n.pagePosition,a.addClass,n.height;var u=l.Plugin.inherit({klassName:"Draggable",pluginName:"lark.dnd.draggable",options:{draggingClass:"dragging",forceFallback:!1},_construct:function(e,r){this.overrided(e,r);var n=this,r=this.options;n.draggingClass=r.draggingClass,["preparing","started","ended","moving"].forEach(function(e){t.isFunction(r[e])&&n.on(e,r[e])}),s.mousy(e),o.on(e,{mousedown:function(e){var r=n.options;r.handle&&(t.isFunction(r.handle)?n.dragHandle=r.handle(e.target,n._elm):n.dragHandle=i.closest(e.target,r.handle,n._elm),!n.dragHandle)||(r.source?t.isFunction(r.source)?n.dragSource=r.source(e.target,n._elm):n.dragSource=i.closest(e.target,r.source,n._elm):n.dragSource=n._elm,n.startPos={x:e.clientX,y:e.clientY},c.prepare(n,e))},mouseup:function(t){},dragstart:function(t){c.dragging===n&&c.start(n,t)},dragend:function(t){c.dragging===n&&(o.stop(t),c.dragging&&c.end(!1))}})}});return l.register(u,"draggable"),d.Draggable=u}),t("skylark-domx-plugins-dnd/droppable",["skylark-langx/langx","skylark-domx-noder","skylark-domx-data","skylark-domx-finder","skylark-domx-geom","skylark-domx-eventer","skylark-domx-styler","skylark-domx-plugins-base","./dnd","./manager"],function(t,e,r,i,n,o,a,s,l,d){o.on,o.off,r.attr,r.removeAttr,n.pagePosition,a.addClass,n.height;var c=s.Plugin.inherit({klassName:"Droppable",pluginName:"lark.dnd.droppable",options:{draggingClass:"dragging"},_construct:function(e,r){this.overrided(e,r);var i,n,s=this,r=s.options,l=(r.draggingClass,!0);["started","entered","leaved","dropped","overing"].forEach(function(e){t.isFunction(r[e])&&s.on(e,r[e])}),o.on(e,{dragover:function(t){if(t.stopPropagation(),l){var e=o.create("overing",{originalEvent:t,overElm:t.target,transfer:d.draggingTransfer,acceptable:!0});s.trigger(e),e.acceptable&&t.preventDefault()}},dragenter:function(t){s.options;var e=s._elm,r=o.create("entered",{originalEvent:t,transfer:d.draggingTransfer});s.trigger(r),t.stopPropagation(),i&&l&&a.addClass(e,i)},dragleave:function(t){s.options;var e=s._elm;if(!l)return!1;var r=o.create("leaved",{originalEvent:t,transfer:d.draggingTransfer});s.trigger(r),t.stopPropagation(),i&&l&&a.removeClass(e,i)},drop:function(t){s.options;var e=s._elm;if(o.stop(t),d.dragging){i&&l&&a.addClass(e,i);var r=o.create("dropped",{originalEvent:t,transfer:d.draggingTransfer});s.trigger(r),d.end(!0)}}}),d.on("dndStarted",function(t){var r=o.create("started",{transfer:d.draggingTransfer,acceptable:!1,dragging:t.dragging});s.trigger(r),l=r.acceptable,i=r.hoverClass,(n=r.activeClass)&&l&&a.addClass(e,n)}).on("dndEnded",function(t){var r=o.create("ended",{transfer:d.draggingTransfer,acceptable:!1});s.trigger(r),i&&l&&a.removeClass(e,i),n&&l&&a.removeClass(e,n),l=!1,n=null,i=null})}});return s.register(c,"droppable"),l.Droppable=c}),t("skylark-langx-emitter/Emitter",["skylark-langx-events"],function(t){return t.Emitter}),t("skylark-dragula/_helpers",["skylark-langx/skylark","skylark-devices-points/mouse","skylark-devices-points/touch","skylark-domx-noder","skylark-domx-finder","skylark-domx-geom","skylark-domx-eventer","skylark-domx-styler"],function(t,e,r,i,n,o,a,s){"use strict";function l(t){return t.targetTouches&&t.targetTouches.length?t.targetTouches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t}return{touchy:function(t,e,i,n){"add"==e?a.on(t,i,n):a.off(t,i,n);t.touchInited||(t.touchInited=!0,r.mousy(t))},whichMouseButton:function(t){if(void 0!==t.touches)return t.touches.length;if(void 0!==t.which&&0!==t.which)return t.which;if(void 0!==t.buttons)return t.buttons;var e=t.button;if(void 0!==e)return 1&e?1:2&e?3:4&e?2:0},getRectWidth:function(t){return t.width||t.right-t.left},getRectHeight:function(t){return t.height||t.bottom-t.top},getEventHost:l,getCoord:function(t,e){var r=l(e),i={pageX:"clientX",pageY:"clientY"};t in i&&!(t in r)&&i[t]in r&&(t=i[t]);return r[t]}}}),t("skylark-dragula/_drake",["skylark-langx/skylark","skylark-langx-emitter/Emitter","skylark-devices-points/mouse","skylark-devices-points/touch","skylark-domx-noder","skylark-domx-finder","skylark-domx-geom","skylark-domx-eventer","skylark-domx-styler","./_helpers"],function(t,e,r,i,n,o,a,s,l,d){"use strict";var c=e.inherit({_source:null,_item:null,_initialSibling:null,_currentSibling:null,_renderTimer:null,_copy:null,_lastDropTarget:null,_prepareArgs:function(t,e){return e},init:function(t){this.containers=t.containers,this.destroy=t.destroy,this.options=t,this.dragging=!1},isContainer:function(t){return-1!==this.containers.indexOf(t)||this.options.isContainer(t)},isCopy:function(t,e){var r=this.options;return"boolean"==typeof r.copy?r.copy:r.copy(t,e)},findDropTarget:function(t,e){for(var r=n.fromPoint(t,e),i=r,a=this;i&&!s();)i=o.parent(i);return i;function s(){var n=a.isContainer(i);if(!1===n)return!1;var o=a.getImmediateChild(i,r),s=a.getReference(i,o,t,e),l=a.isInitialPlacement(i,s);return!!l||a.options.accepts(a._item,i,a._source,s)}},isInitialPlacement:function(t,e){var r;return r=void 0!==e?e:o.nextSibling(this._copy||this._item),t===this._source&&r===this._initialSibling},getReference:function(t,e,r,i){var n=this.options,s="horizontal"===n.direction;return e!==t?function(){var t=a.boundingRect(e);if(s)return l(r>t.left+d.getRectWidth(t)/2);return l(i>t.top+d.getRectHeight(t)/2)}():function(){var e=t.children.length;for(let n=0;n<e;n++){let e=t.children[n],o=a.boundingRect(e);if(s&&o.left+o.width/2>r)return e;if(!s&&o.top+o.height/2>i)return e}return null}();function l(t){return t?o.nextSibling(e):e}},getImmediateChild:function(t,e){for(var r=e;r!==t&&o.parent(r)!==t;)r=o.parent(r);return r===n.root()?null:r},canStart:function(t){if(!this.dragging&&!(this.isContainer(t)||this.options.ignoreInputTextSelection&&n.isInput(t))){for(var e=t,r=this.options;o.parent(t)&&!1===this.isContainer(o.parent(t));){if(r.invalid(t,e))return;if(!(t=o.parent(t)))return}var i=o.parent(t);if(i&&!r.invalid(t,e)){var a=r.moves(t,i,e,o.nextSibling(t));if(a)return{item:t,source:i}}}},canMove:function(t){return!!this.canStart(t)},manualStart:function(t){var e=this.canStart(t);e&&this.start(e)},start:function(t){this.isCopy(t.item,t.source)&&(this._copy=t.item.cloneNode(!0),this.emit("cloned",this._copy,t.item,"copy")),this._source=t.source,this._item=t.item,this._initialSibling=this._currentSibling=o.nextSibling(t.item),this.dragging=!0,this.emit("drag",this._item,this._source)},over:function(t,e){var r=this.options,i=this._copy||this._item,a=this,s=n.fromPoint(t,e),l=this.findDropTarget(t,e),d=null!==l&&l!==this._lastDropTarget;(d||null===l)&&(a._lastDropTarget&&h("out"),this._lastDropTarget=l,d&&h("over"));var c=o.parent(i);if(l!==this._source||!this._copy||r.copySortSource){var u,g=this.getImmediateChild(l,s);if(null!==g)u=this.getReference(l,g,t,e);else{if(!0!==r.revertOnSpill||this._copy)return void(this._copy&&c&&c.removeChild(i));u=this._initialSibling,l=this._source}(null===u&&d||u!==i&&u!==o.nextSibling(i))&&(this._currentSibling=u,l.insertBefore(i,u),this.emit("shadow",i,l,this._source))}else c&&c.removeChild(i);function h(t){a.emit(t,i,a._lastDropTarget,a._source)}},end:function(){if(this.dragging){var t=this._copy||this._item;this.drop(t,o.parent(t))}},drop:function(t,e){var r=o.parent(t);this._copy&&this.options.copySortSource&&e===this._source&&r.removeChild(this._item),this.isInitialPlacement(e)?this.emit("cancel",t,this._source,this._source):this.emit("drop",t,e,this._source,this._currentSibling),this.cleanup()},remove:function(){if(this.dragging){var t=this._copy||this._item,e=o.parent(t);e&&e.removeChild(t),this.emit(_copy?"cancel":"remove",t,e,this._source),this.cleanup()}},cancel:function(t){if(this.dragging){var e=this.options,r=arguments.length>0?t:e.revertOnSpill,i=this._copy||this._item,n=o.parent(i),a=this.isInitialPlacement(n);!1===a&&r&&(this._copy?n&&n.removeChild(this._copy):this._source.insertBefore(i,this._initialSibling)),a||r?this.emit("cancel",i,this._source,this._source):this.emit("drop",i,n,this._source,this._currentSibling),this.cleanup()}},cleanup:function(){var t=this._copy||this._item;t&&l.removeClass(t,"gu-transit"),this._renderTimer&&clearTimeout(_renderTimer),this.dragging=!1,this._lastDropTarget&&this.emit("out",t,this._lastDropTarget,this._source),this.emit("dragend",t),this._source=this._item=this._copy=this._initialSibling=this._currentSibling=this._renderTimer=this._lastDropTarget=null}});return c}),t("skylark-dragula/dragula",["skylark-langx/skylark","skylark-devices-points/mouse","skylark-devices-points/touch","skylark-domx-noder","skylark-domx-finder","skylark-domx-geom","skylark-domx-eventer","skylark-domx-styler","skylark-domx-plugins-dnd/draggable","skylark-domx-plugins-dnd/droppable","./_drake"],function(t,e,r,i,n,o,a,s,l,d,c){"use strict";return t.attach("intg.dragula",function(t,e){1===arguments.length&&!1===Array.isArray(t)&&(e=t,t=[]);var r=e||{};void 0===r.moves&&(r.moves=a);void 0===r.accepts&&(r.accepts=a);void 0===r.invalid&&(r.invalid=function(){return!1});void 0===r.containers&&(r.containers=t||[]);void 0===r.isContainer&&(r.isContainer=function(){return!1});void 0===r.copy&&(r.copy=!1);void 0===r.copySortSource&&(r.copySortSource=!1);void 0===r.revertOnSpill&&(r.revertOnSpill=!1);void 0===r.removeOnSpill&&(r.removeOnSpill=!1);void 0===r.direction&&(r.direction="vertical");void 0===r.ignoreInputTextSelection&&(r.ignoreInputTextSelection=!0);void 0===r.mirrorContainer&&(r.mirrorContainer=i.body());r.destroy=function(){};var n,o=new c(r);!0===r.removeOnSpill&&o.on("over",function(t){s.removeClass(t,"gu-hide")}).on("out",function(t){o.dragging&&s.addClass(t,"gu-hide")});return o.draggable=new l(i.body(),{preparing:function(t){n=o.canStart(t.originalEvent.target),t.dragSource=n?n.item:null},started:function(t){t.ghost=t.dragSource,o.start(n)},ended:function(t){o.end(),n=null},drake:o}),o.droppable=new d(i.body(),{started:function(t){t.dragging===o.draggable&&(t.acceptable=!0,t.activeClass="active",t.hoverClass="over")},overing:function(t){o.over(t.originalEvent.clientX,t.originalEvent.clientY)},dropped:function(t){},drake:o}),o;function a(){return!0}})}),t("skylark-dragula/main",["./dragula"],function(t){return t}),t("skylark-dragula",["skylark-dragula/main"],function(t){return t})}(r),!i){var a=require("skylark-langx-ns");n?module.exports=a:e.skylarkjs=a}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-dragula.js.map
