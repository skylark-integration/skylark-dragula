/**
 * skylark-dragula - A version of dragula.js that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-dragula/
 * @license MIT
 */
!function(t,e){var i=e.define,require=e.require,r="function"==typeof i&&i.amd,n=!r&&"undefined"!=typeof exports;if(!r&&!i){var o={};i=e.define=function(t,e,i){"function"==typeof i?(o[t]={factory:i,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var i=e.split("/"),r=t.split("/");i.pop();for(var n=0;n<r.length;n++)"."!=r[n]&&(".."==r[n]?i.pop():i.push(r[n]));return i.join("/")}(e,t)}),resolved:!1,exports:null},require(t)):o[t]={factory:null,resolved:!0,exports:i}},require=e.require=function(t){if(!o.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=o[t];if(!module.resolved){var i=[];module.deps.forEach(function(t){i.push(require(t))}),module.exports=module.factory.apply(e,i)||null,module.resolved=!0}return module.exports}}if(!i)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-langx-emitter/Emitter",["skylark-langx-events"],function(t){return t.Emitter}),t("skylark-dragula/_helpers",["skylark-langx/skylark","skylark-devices-points/mouse","skylark-devices-points/touch","skylark-domx-noder","skylark-domx-finder","skylark-domx-geom","skylark-domx-eventer","skylark-domx-styler"],function(t,e,i,r,n,o,s,a){"use strict";function l(t){return t.targetTouches&&t.targetTouches.length?t.targetTouches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t}return{touchy:function(t,e,r,n){"add"==e?s.on(t,r,n):s.off(t,r,n);t.touchInited||(t.touchInited=!0,i.mousy(t))},whichMouseButton:function(t){if(void 0!==t.touches)return t.touches.length;if(void 0!==t.which&&0!==t.which)return t.which;if(void 0!==t.buttons)return t.buttons;var e=t.button;if(void 0!==e)return 1&e?1:2&e?3:4&e?2:0},getRectWidth:function(t){return t.width||t.right-t.left},getRectHeight:function(t){return t.height||t.bottom-t.top},getEventHost:l,getCoord:function(t,e){var i=l(e),r={pageX:"clientX",pageY:"clientY"};t in r&&!(t in i)&&r[t]in i&&(t=r[t]);return i[t]}}}),t("skylark-dragula/_drake",["skylark-langx/skylark","skylark-langx-emitter/Emitter","skylark-devices-points/mouse","skylark-devices-points/touch","skylark-domx-noder","skylark-domx-finder","skylark-domx-geom","skylark-domx-eventer","skylark-domx-styler","./_helpers"],function(t,e,i,r,n,o,s,a,l,u){"use strict";var c=e.inherit({_source:null,_item:null,_initialSibling:null,_currentSibling:null,_renderTimer:null,_copy:null,_lastDropTarget:null,_prepareArgs:function(t,e){return e},init:function(t){this.containers=t.containers,this.destroy=t.destroy,this.options=t},isContainer:function(t){return-1!==this.containers.indexOf(t)||this.options.isContainer(t)},isCopy:function(t,e){var i=this.options;return"boolean"==typeof i.copy?i.copy:i.copy(t,e)},findDropTarget:function(t,e){for(var i=n.fromPoint(t,e),r=i,s=this;r&&!a();)r=o.parent(r);return r;function a(){var n=s.isContainer(r);if(!1===n)return!1;var o=s.getImmediateChild(r,i),a=s.getReference(r,o,t,e),l=s.isInitialPlacement(r,a);return!!l||s.options.accepts(s._item,r,s._source,a)}},isInitialPlacement:function(t,e){var i;return i=void 0!==e?e:o.nextSibling(this._copy||this._item),t===this._source&&i===this._initialSibling},getReference:function(t,e,i,r){var n=this.options,a="horizontal"===n.direction;return e!==t?function(){var t=s.boundingRect(e);if(a)return l(i>t.left+u.getRectWidth(t)/2);return l(r>t.top+u.getRectHeight(t)/2)}():function(){var e=t.children.length;for(let n=0;n<e;n++){let e=t.children[n],o=s.boundingRect(e);if(a&&o.left+o.width/2>i)return e;if(!a&&o.top+o.height/2>r)return e}return null}();function l(t){return t?o.nextSibling(e):e}},getImmediateChild:function(t,e){for(var i=e;i!==t&&o.parent(i)!==t;)i=o.parent(i);return i===n.root()?null:i},canStart:function(t){if(!this.dragging&&!(this.isContainer(t)||this.options.ignoreInputTextSelection&&n.isInput(t))){for(var e=t,i=this.options;o.parent(t)&&!1===this.isContainer(o.parent(t));){if(i.invalid(t,e))return;if(!(t=o.parent(t)))return}var r=o.parent(t);if(r&&!i.invalid(t,e)){var s=i.moves(t,r,e,o.nextSibling(t));if(s)return{item:t,source:r}}}},canMove:function(t){return!!this.canStart(t)},manualStart:function(t){var e=this.canStart(t);e&&this.start(e)},start:function(t){this.isCopy(t.item,t.source)&&(this._copy=t.item.cloneNode(!0),this.emit("cloned",this._copy,t.item,"copy")),this._source=t.source,this._item=t.item,this._initialSibling=this._currentSibling=o.nextSibling(t.item),this.dragging=!0,this.emit("drag",this._item,this._source)},over:function(t,e){var i=this.options,r=this._copy||this._item,s=this,a=n.fromPoint(t,e),l=this.findDropTarget(t,e),u=null!==l&&l!==this._lastDropTarget;(u||null===l)&&(s._lastDropTarget&&p("out"),this._lastDropTarget=l,u&&p("over"));var c=o.parent(r);if(l!==this._source||!this._copy||i.copySortSource){var h,d=this.getImmediateChild(l,a);if(null!==d)h=this.getReference(l,d,t,e);else{if(!0!==i.revertOnSpill||this._copy)return void(this._copy&&c&&c.removeChild(r));h=this._initialSibling,l=this._source}(null===h&&u||h!==r&&h!==o.nextSibling(r))&&(this._currentSibling=h,l.insertBefore(r,h),this.emit("shadow",r,l,this._source))}else c&&c.removeChild(r);function p(t){s.emit(t,r,s._lastDropTarget,s._source)}},end:function(){if(this.dragging){var t=this._copy||this._item;this.drop(t,o.parent(t))}},drop:function(t,e){var i=o.parent(t);this._copy&&this.options.copySortSource&&e===this._source&&i.removeChild(this._item),this.isInitialPlacement(e)?this.emit("cancel",t,this._source,this._source):this.emit("drop",t,e,this._source,this._currentSibling),this.cleanup()},remove:function(){if(this.dragging){var t=this._copy||this._item,e=o.parent(t);e&&e.removeChild(t),this.emit(_copy?"cancel":"remove",t,e,this._source),this.cleanup()}},cancel:function(t){if(this.dragging){var e=this.options,i=arguments.length>0?t:e.revertOnSpill,r=this._copy||this._item,n=o.parent(r),s=this.isInitialPlacement(n);!1===s&&i&&(this._copy?n&&n.removeChild(this._copy):this._source.insertBefore(r,this._initialSibling)),s||i?this.emit("cancel",r,this._source,this._source):this.emit("drop",r,n,this._source,this._currentSibling),this.cleanup()}},cleanup:function(){var t=this._copy||this._item;t&&l.removeClass(t,"gu-transit"),this._renderTimer&&clearTimeout(_renderTimer),this.dragging=!1,this._lastDropTarget&&this.emit("out",t,this._lastDropTarget,this._source),this.emit("dragend",t),this._source=this._item=this._copy=this._initialSibling=this._currentSibling=this._renderTimer=this._lastDropTarget=null}});return c}),t("skylark-dragula/_listen",["skylark-langx/skylark","skylark-devices-points/mouse","skylark-devices-points/touch","skylark-domx-noder","skylark-domx-finder","skylark-domx-geom","skylark-domx-eventer","skylark-domx-styler","./_helpers"],function(t,e,i,r,n,o,s,a,l){"use strict";var u=r.root();return function(t,e){var i,c,h,d,p,g;function f(t){p&&t.preventDefault()}function m(t){var e=t?"remove":"add";l.touchy(u,e,"mousemove",k)}function v(t){var e=t?"off":"on";s[e](u,"selectstart",f),s[e](u,"click",f)}function y(e){h=e.clientX,d=e.clientY;var i=1!==l.whichMouseButton(e)||e.metaKey||e.ctrlKey;if(!i){var n=e.target,o=t.canStart(n);o&&(p=o,m(),"mousedown"===e.type&&(r.isInput(n)?n.focus():e.preventDefault()))}}function k(r){if(p)if(0!==l.whichMouseButton(r)){if(void 0===r.clientX||r.clientX!==h||void 0===r.clientY||r.clientY!==d){var n=p;m(!0),v(),t.end(),t.start(n);var s=o.pagePosition(t._item);i=l.getCoord("pageX",r)-s.left,c=l.getCoord("pageY",r)-s.top,a.addClass(t._copy||t._item,"gu-transit"),function(){if(g)return;var i=t._item.getBoundingClientRect();(g=t._item.cloneNode(!0)).style.width=l.getRectWidth(i)+"px",g.style.height=l.getRectHeight(i)+"px",a.removeClass(g,"gu-transit"),a.addClass(g,"gu-mirror"),e.mirrorContainer.appendChild(g),l.touchy(u,"add","mousemove",S),a.addClass(e.mirrorContainer,"gu-unselectable"),t.emit("cloned",g,t._item,"mirror")}(),S(r)}}else x({})}function _(){p=!1,m(!0),v(!0)}function x(i){if(_(),g&&(a.removeClass(e.mirrorContainer,"gu-unselectable"),l.touchy(u,"remove","mousemove",S),n.parent(g).removeChild(g),g=null),t.dragging){var r=t._copy||t._item,o=l.getCoord("clientX",i),s=l.getCoord("clientY",i),c=t.findDropTarget(o,s);c&&(t._copy&&e.copySortSource||!t._copy||c!==t._source)?t.drop(r,c):e.removeOnSpill?t.remove():t.cancel()}}function S(e){if(g){e.preventDefault();var r,n,o=l.getCoord("clientX",e),s=l.getCoord("clientY",e);r=o-i,n=s-c,g.style.left=r+"px",g.style.top=n+"px",t.over(o,s)}}return{events:function(t){var e=t?"remove":"add";l.touchy(u,e,"mousedown",y),l.touchy(u,e,"mouseup",x)},grab:y,ungrab:_,release:x}}}),t("skylark-dragula/dragula",["skylark-langx/skylark","skylark-devices-points/mouse","skylark-devices-points/touch","skylark-domx-noder","skylark-domx-finder","skylark-domx-geom","skylark-domx-eventer","skylark-domx-styler","./_drake","./_listen"],function(t,e,i,r,n,o,s,a,l,u){"use strict";return t.attach("intg.dragula",function(t,e){1===arguments.length&&!1===Array.isArray(t)&&(e=t,t=[]);var i=e||{};void 0===i.moves&&(i.moves=s);void 0===i.accepts&&(i.accepts=s);void 0===i.invalid&&(i.invalid=function(){return!1});void 0===i.containers&&(i.containers=t||[]);void 0===i.isContainer&&(i.isContainer=function(){return!1});void 0===i.copy&&(i.copy=!1);void 0===i.copySortSource&&(i.copySortSource=!1);void 0===i.revertOnSpill&&(i.revertOnSpill=!1);void 0===i.removeOnSpill&&(i.removeOnSpill=!1);void 0===i.direction&&(i.direction="vertical");void 0===i.ignoreInputTextSelection&&(i.ignoreInputTextSelection=!0);void 0===i.mirrorContainer&&(i.mirrorContainer=r.body());i.destroy=function(){o.events(!0),o.release({})};var n=new l(i);!0===i.removeOnSpill&&n.on("over",function(t){a.removeClass(t,"gu-hide")}).on("out",function(t){n.dragging&&a.addClass(t,"gu-hide")});var o=u(n,i);return o.events(),n;function s(){return!0}})}),t("skylark-dragula/main",["./dragula"],function(t){return t}),t("skylark-dragula",["skylark-dragula/main"],function(t){return t})}(i),!r){var s=require("skylark-langx-ns");n?module.exports=s:e.skylarkjs=s}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-dragula.js.map
